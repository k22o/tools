# RDB/SQLについて

## 設計

### DBの3層スキーマ

- 外部スキーマ: ユーザーから見た定義。出力されるデータやビュー。
- 概念スキーマ: データの関連性などを示す設計図。
- 内部スキーマ: 概念スキーマをDBにいれるための情報。物理設計時に決定される。

### 設計のフェーズ

- 概念設計: エンティティ（テーブル）と関連（リレーション）にデータを落とし込む。
- 論理設計: データ型の定義や正規化を行い、ER図を作成する。 (概念と一緒くたに論理設計と呼ばれることも)
- 物理設計: テーブル定義・インデックス定義・DBの構成検討などを行う

### 制約

- check 制約: 値が10以上である必要がある、など
- not null 制約
- unique 制約
- primary key 制約: not null + unique
- foreign key 制約
  - no action (default): 反した場合は、エラーを出して何もしない
  - cascade: 参照する側とされる側を連動させる
  - set null: 対応行がなくなった参照列にnullを設定
  - set default: 対応行がなくなった参照列にdefaultを設定

## 正規化と演算
- [正規化](./normalization.md)
- [演算](./calculation.md)

## SQLの仕組み

- view
  - 仮想的なテーブル
- cursor
  -1度に1行ずつデータの検索と操作をできるようにする仕組み
  - プログラム言語からSQLを呼ぶ際に使われる。COBOLなど昔の言語では1行ずつしか処理できなかったため
- trigger
  - あるテーブルを更新した際に、連動して別のテーブルも更新する仕組み
  - 後述するストアドプロシージャの実装の１つ。
- sequence
  - 独自に連続したデータを作成する仕組み
- stored procedure: DBMS内に保存されている事前にコンパイルされたSQLコードの塊のこと。以下の特徴がある。
  - 再利用性: データベース内に保存されており、アプリケーションから呼び出すことができ、同じロジックを複数の場所で再利用できる。
  - パフォーマンス: データベースにプリコンパイルされて保存されるため、実行速度の向上と、ネットワークトラフィックの削減に寄与する。
  - セキュリティ: データベース内で実行されるため、適切なアクセス権の設定によりセキュリティを確保できる。
  - データ整合性の強制: スデータ整合性を強制するための条件やビジネスルールを実装できる

## DBMSについて

[DBMSについて](./dbms.md)