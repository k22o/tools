# 代表的な攻撃

※ 個別には記載していないが、同一オリジンポリシーやCORSの設定も攻撃の対策に寄与している

## XSS

不正なスクリプトを攻撃対象ページに挿入して、不正スクリプトを実行させる。
対策は以下の通り。

- エスケープ -> [別ファイル](../sanitize.md)
- 入力ボックスで想定される文字 (e.g. 数字) 以外は受け付けないようにする
- DOM操作用のメソッドなどを利用
  - innerHTMLでdomを差し込まない

## CSRF

正式なログイン用cookieなどを利用して罠サイトを通して不正アクセスさせる。
対策は以下の通り。

- トークンの利用
- double submit cookieの利用
- cookieにsame site属性を設定
- originヘッダの値を都度検証する

## Buffer Overflow

文字入力を利用した攻撃で、バッファを超えた入力を与えることで、予期せぬメモリの値を書き換える。
対策は以下の通り。

- コンパイル時にスタック保護の機能を利用する
- あらかじめ定めた上限の領域を確保して、そこまでの文字数しか受け付けなくする

## クリックジャッキング

ユーザの意図とは異なるボタン等をクリックさせて意図しない挙動を実行させる。例えば、iframeで埋め込んだページの上に罠サイト独自のボタンを置き、罠サイトのボタンを押したつもりがその下のiframeを実行してしまう。  
x-frame-optionsを利用して防ぐ。

## オープンリダイレクト

webアプリケーションのリダイレクト機能を利用して罠サイトなどに遷移させる。たとえばクエリパラメータでリダイレクト先を渡したり、入力値に応じてリダイレクト先を指定する場合に発生する。
リダイレクト先urlの検証コードを入れることで防止できる。

## SQLインジェクション

不正なコードを入力値として与えることで。SQL文が実行された際にDBのデータを入手したり破壊したりする。
対応策としては、以下の通り。

- prepared statementの機能を利用してエスケープする
- 入力ボックスで想定される文字 (e.g. 数字) 以外は受け付けないようにする

## OSコマンドインジェクション

SQLインジェクションのOS版。OSのコマンドを実行させる。
対応策としては、以下の通り。

- エスケープ処理
- そもそもOSコマンドをアプリケーションからの入力をもとに実行しない

## DoS/DDoS攻撃系

[別ファイル](./dos.md) を参照

## ブルートフォース攻撃

主にパスワードを不正に入手するために用いられ、考えられるパターンを総当たり的に試す。
対応策としては、以下の通り。

- パスワードを複雑にさせる (桁数・文字種)
- ワンタイムパスワードや生体認証、2FAの利用
- 一定回数のミスでブロック

## DNSキャッシュポイズニング

DNSのキャッシュを不正に書き換えることで、誤ったIPアドレスを応答させて偽サーバに誘導する。対応策は以下の通り。

- DNS問い合わせに利用するDNSヘッダのIDをランダムに変更する。同じ値だと、IDがばれた際に偽の応答を送り付けられる可能性が高まる。

## SEOポイズニング

検索再度の順位アルゴリズムを悪用して、悪意のあるサイトの順位を上げること

## SEOスパム

広告収入やアクセス数のために、キーワードと関係の薄いサイトを不正に上位に表示すること

## サイドチャネル攻撃

非破壊攻撃の一種。攻撃対象の物理デバイスから得られる物理量 (処理時間や消費電力など) やエラーメッセージから、内部情報を解析する。
暗号アルゴリズムを実装したシステムに適用することで、暗号解読の手がかりとなる。

## 中間者攻撃

通信を行う2者間に割り込んで、情報をすり替えることで、その後の通信を盗聴する。

## テンペスト攻撃

処理中に機器から放出される電磁波を利用して、キー入力や画面表示などの情報を解析する。
