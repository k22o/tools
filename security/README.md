# 関連ページ
https://cve.mitre.org/


## 代表的な攻撃
※ 個別には記載していないが、同一オリジンポリシーやCORSの設定も攻撃の対策に寄与している

### XSS
不正なスクリプトを攻撃対象ページに挿入して、不正スクリプトを実行させる。
対策は以下の通り。
- エスケープ (後述)
- 入力ボックスで想定される文字 (e.g. 数字) 以外は受け付けないようにする
- DOM操作用のメソッドなどを利用
    - innerHTMLでdomを差し込まない

### CSRF
正式なログイン用cookieなどを利用して罠サイトを通して不正アクセスさせる。
対策は以下の通り。
- トークンの利用
- double submit cookieの利用
- cookieにsame site属性を設定
- originヘッダの値を都度検証する

### Buffer Overflow
文字入力を利用した攻撃で、バッファを超えた入力を与えることで、予期せぬメモリの値を書き換える。
対策は以下の通り。
- コンパイル時にスタック保護の機能を利用する
- あらかじめ定めた上限の領域を確保して、そこまでの文字数しか受け付けなくする

### クリックジャッキング
ユーザの意図とは異なるボタン等をクリックさせて意図しない挙動を実行させる。例えば、iframeで埋め込んだページの上に罠サイト独自のボタンを置き、罠サイトのボタンを押したつもりがその下のiframeを実行してしまう。    
x-frame-optionsを利用して防ぐ。

### オープンリダイレクト
webアプリケーションのリダイレクト機能を利用して罠サイトなどに遷移させる。たとえばクエリパラメータでリダイレクト先を渡したり、入力値に応じてリダイレクト先を指定する場合に発生する。
リダイレクト先urlの検証コードを入れることで防止できる。

### SQLインジェクション
不正なコードを入力値として与えることで。SQL文が実行された際にDBのデータを入手したり破壊したりする。
対応策としては、以下の通り。
- prepared statementの機能を利用してエスケープする
- 入力ボックスで想定される文字 (e.g. 数字) 以外は受け付けないようにする

### OSコマンドインジェクション
SQLインジェクションのOS版。OSのコマンドを実行させる。
対応策としては、以下の通り。
- エスケープ処理
- そもそもOSコマンドをアプリケーションからの入力をもとに実行しない

### DoS/DDoS攻撃
過小なアクセスやデータを送付して、サーバに負荷をかける。
攻撃を検知したら、IPやドメインなどをベースにしてアクセスをブロックすることで対策する。

### ブルートフォース攻撃
主にパスワードを不正に入手するために用いられ、考えられるパターンを総当たり的に試す。
対応策としては、以下の通り。
- パスワードを複雑にさせる (桁数・文字種)
- ワンタイムパスワードや生体認証、2FAの利用
- 一定回数のミスでブロック



## サニタイズ / エスケープ について
XSSやSQLインジェクションなどを防ぐために、サニタイズやエスケープと呼ばれる処理を行う。

- サニタイズ: 入力データをクリーンで安全な形に変換するプロセス
- エスケープ: 特殊文字やメタ文字をエスケープ文字を用いて変換するプロセス。サニタイズの一種とも考えられる

### エスケープ処理について
エスケープ処理は、以下のようなものがある。

- HTMLエスケープ: htmlに文字を表示する際にする。XSS対策に必須。
- URLエンコード: URLに文字を設定する際にするエスケープ処理。文字の誤変換や攻撃を防ぐために利用する。
- SQLエスケープ: SQL用のエスケープ方法。SQLインジェクション対策に必須。
- JSONエスケープ: JSON用のエスケープ方法。
- XMLエスケープ: XML用のエスケープ方法。

### エスケープ以外のサニタイズについて
サニタイズには、エスケープ処理以外に以下のようなものがある
- ファイルアップロードの検証: ファイルの拡張子やファイル形式をチェックする
- ホワイトリスト検証: ホワイトリストに含まれるパターンのみ受け付ける
- データトリミング: 余計な文字 (空白、制御文字など) を削除する
- バリデーション: データが期待されるパターンや条件を満たすか検証する

